<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/assets/css/style.css?v=135b288f3894336b2f97fa7edc4aa93046eba060">

<!-- Begin Jekyll SEO tag v2.3.0 -->
<title>我阅读代码的方法 | 折子戏的学习笔记</title>
<meta property="og:title" content="我阅读代码的方法" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="最近阅读了Redis和NSQ的代码，加上前一段时间研究过的CPython，也算是从开源项目中汲取了一些营养。然而好记性不如烂笔头，如果你有看书看到一半翻回去找前文的经验的话，you know what I means. 在记录代码给我的收获之前，我想先探讨一下阅读代码的方法。" />
<meta property="og:description" content="最近阅读了Redis和NSQ的代码，加上前一段时间研究过的CPython，也算是从开源项目中汲取了一些营养。然而好记性不如烂笔头，如果你有看书看到一半翻回去找前文的经验的话，you know what I means. 在记录代码给我的收获之前，我想先探讨一下阅读代码的方法。" />
<link rel="canonical" href="http://localhost:4000/2017/09/07/readingCode/" />
<meta property="og:url" content="http://localhost:4000/2017/09/07/readingCode/" />
<meta property="og:site_name" content="折子戏的学习笔记" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-09-07T00:00:00+08:00" />
<script type="application/ld+json">
{"name":null,"description":"最近阅读了Redis和NSQ的代码，加上前一段时间研究过的CPython，也算是从开源项目中汲取了一些营养。然而好记性不如烂笔头，如果你有看书看到一半翻回去找前文的经验的话，you know what I means. 在记录代码给我的收获之前，我想先探讨一下阅读代码的方法。","url":"http://localhost:4000/2017/09/07/readingCode/","headline":"我阅读代码的方法","dateModified":"2017-09-07T00:00:00+08:00","datePublished":"2017-09-07T00:00:00+08:00","sameAs":null,"@type":"BlogPosting","author":null,"image":null,"publisher":null,"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2017/09/07/readingCode/"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  </head>
  <body>

    <header>
      <div class="container">
        <h1>折子戏的学习笔记</h1>
        <h2>学习过程中的一些收获和小小感悟</h2>

        <section id="about">
          <a href="/index" class="text">home</a>
          <a href="/about" class="text">about</a>
        </section>
      </div>
    </header>

    <div class="container">
      <section id="main_content">
        <article class="post">
  <h1 class="post-title">我阅读代码的方法</h1>
  <time datetime="2017-09-07T00:00:00+08:00" class="post-date">07 Sep 2017</time>
  <p>最近阅读了Redis和NSQ的代码，加上前一段时间研究过的CPython，也算是从开源项目中汲取了一些营养。然而好记性不如烂笔头，如果你有看书看到一半翻回去找前文的经验的话，you know what I means.
在记录代码给我的收获之前，我想先探讨一下阅读代码的方法。</p>

<p>网上有非常多的“如果阅读XX源码”之类的文章，但我认为并不存在一种普适的阅读方法。比如有的人只是想了解Redis里面跳表的实现方式，他就没有必要去关注整个Redis的体系。有的人喜欢自顶向下，由点及面，有的人喜欢自底向上，垒百尺高台。所以我这里记录的只是适用于我自己（或我这一类码农）的方法。</p>

<h2 id="一个好的ide">一个好的IDE</h2>
<p>工欲善其事，必先利其器。优秀的IDE能帮助你在阅读时节省大量的时间。虽然我一直坚持认为vim是最好的编辑器，但是阅读代码我还是更喜欢使用VSCode。当然，vim插件是必不可少的。
为什么使用VSCode，请参考百度。</p>

<h2 id="熟悉语言特性">熟悉语言特性</h2>
<p>不同的语言有不同的编程风格，这会导致不同语言实现同一功能的代码大不相同。这一点常被我忽视，因而花费了大量的时间去研究某一段在该语言很常见的功能。比如在阅读Chronos代码时的依赖注入和mock，以及NSQ代码中随处可见的select-case-default结构。</p>

<h2 id="熟悉产品理解功能模块">熟悉产品，理解功能模块</h2>
<p>一般来说，阅读代码都是在实际开发中遇到问题，或者有需要参考的模块。如果单纯为了学习而阅读代码，往往找不到要点所在。容易出现的一个问题是，尝试从某一个点切入，却发现牵扯得越来越多，最后像无头苍蝇般找不到清晰的脉络。原因就是对整个产品不了解，不清楚要阅读的代码属于其中的哪一部分，跟别的模块之间有什么关联。</p>

<p>我比较喜欢的一种方式是先找到项目的官方网站，找到documentation部分，阅读其中项目的介绍，设计模型和原理，API介绍。然后本地搭建环境(Docker)，把代码跑起来。最好是自己编译，因为可能会对代码做一些修改，测试某些功能。如果项目有API，最好把这些API都调用一遍，了解每个API的用途和用法。再和设计原理结合起来，就大概知道项目的功能模块划分了。</p>

<h2 id="从整体到局部先大体框架再深入细节">从整体到局部，先大体框架，再深入细节</h2>
<p>这一点因人而异吧。如果把代码看做是一个三层的树，根节点（第0层）是代码入口，第1层是各模块划分，第2层是各模块具体实现。那么我通常会采取BFS的阅读方式，即先知道代码由哪些模块组成，然后再深入到细枝末节（这样会显得比较从容）。这样的好处是，你有充分的想象空间从脑子里面设想自己的实现方式，对比发现自己的差距。同时也能更加清晰地把握代码的走向。不好的地方就是，需要的buffer比较多，可能会花费比较多的精力在代码的跳转上，落到具体实现代码的时间比较长一些。如果跳过那么多不熟悉的代码让你惴惴不安，那么还是采用DFS吧。</p>

<h2 id="有侧重点勤于思考善于记录">有侧重点，勤于思考，善于记录</h2>
<p>侧重于你关注的内容，跳过那些乱七八糟的初始化、清理、测试代码（如果你不是专门为了读这个的话）。思考作者为什么要采用这种方式来实现功能。比如Redis里面的压缩表(ziplist)，查找效率根本就比不上hash表。如上所述，如果你理解Redis的设计目的是作为一个内存数据库，那么就应该知道它最最终的是内存使用效率，所以在内存量比较小的时候，适当牺牲时间效率来换取更好的空间效率。每当获得一些新的启示，就把他们记录下来。That’s what i’m trying to learn.</p>

<h2 id="善用搜索引擎">善用搜索引擎</h2>
<p>遇到看不懂的代码怎么办？求助Google爸爸吧！一般情况下，stackoverflow和CSDN可以助你一臂之力。如果你有好的答案，记得回馈。</p>

<p>最后，感谢伟大的开源！</p>

<p><a href="./">back</a></p>

</article>



      </section>
    </div>

    
  </body>
</html>
